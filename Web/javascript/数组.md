## 数组

### 创建数组

创建一个长度为 6 的空数组

```javascript
// 使用 Array 构造器，可以自定义长度
var a = Array(6); // [empty × 6]
// 使用对象字面量
var b = [];
b.length = 6; // [undefined × 6]
```

**`Array()`** 构造器用于创建 [`Array`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array) 对象。

```javascript
new Array(element0, element1, /* … ,*/ elementN)
new Array(arrayLength)
```

### ES6新增构造方法：Array.of 和 Array.from

Array.of 用于将参数依次转化为数组中的一项，然后返回这个新数组，而不管这个参数是数字还是其他。

```javascript
Array.of(8.0); // [8]
Array(8.0); // [empty × 8]  区别
Array.of(8.0, 5); // [8, 5]
Array(8.0, 5); // [8, 5]
Array.of('8'); // ["8"]
Array('8'); // ["8"]
```

**`Array.from()`** 方法对一个类似数组或可迭代对象创建一个新的，浅拷贝的数组实例。

```js
console.log(Array.from('foo'));
// expected output: Array ["f", "o", "o"]

console.log(Array.from([1, 2, 3], x => x + x));
// expected output: Array [2, 4, 6]
```

[参数](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/from#参数)

- `arrayLike`

  想要转换成数组的伪数组对象或可迭代对象。

- `mapFn` 可选

  如果指定了该参数，新数组中的每个元素会执行该回调函数。

- `thisArg` 可选

  可选参数，执行回调函数 `mapFn` 时 `this` 对象。

[返回值](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/from#返回值)

一个新的[`数组`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array)实例。

通过 Array.from 这个方法可以自己定义加工函数的处理方式，从而返回想要得到的值；如果不确定返回值，则会返回 undefined，最终生成的也是一个包含若干个 undefined 元素的空数组。

```javascript
var obj = {0: 'a', 1: 'b', 2:'c', length: 3};
Array.from(obj, function(value, index){
  // console.log(value, index, this, arguments.length);
  return value.repeat(3);   //必须指定返回值，否则返回 undefined
}, obj);
//(3) ['aaa', 'bbb', 'ccc']
//简写
Array.from(obj, (value) => value.repeat(3));
```

### 判断数组类型

Array.isArray 用来判断一个变量是否为数组类型

```js
var a = [];
// 1.基于instanceof
a instanceof Array;
// 2.基于constructor
a.constructor === Array;
// 3.基于Object.prototype.isPrototypeOf
Array.prototype.isPrototypeOf(a);
// 4.基于getPrototypeOf
Object.getPrototypeOf(a) === Array.prototype;
// 5.基于Object.prototype.toString
Object.prototype.toString.apply(a) === '[object Array]';
```

## 数组方法

### 改变自身的方法

- pop
- push
- reverse:反转数组
- shift:删除第一个元素
- sort
- splice:切割数组
- unshift:把元素插入首位置
- copyWithin
- fill

### 不改变自身的方法

- concat：拼接数组
- join：将数组变成字符串
- slice：根据位置切割数组
- toString
- toLocaleString
- indexOf
- lastIndexOf
- 未形成标准的 toSource
- ES7 新增的方法 includes

### 数组遍历方法

1. forEach
2. every
3. some
4. filter
5. map
6. reduce
7. reduceRight
8. ES6 新增的方法 entries、find、findIndex、keys、values。

![image-20220913215209122](D:\Github\Notes\Web\image\image-20220913215209122.png)

## 数组扁平化

数组扁平化在一些多维数组的应用场景中会出现。

1. 怎样用最普通的方法解决数组扁平化问题？

2. ES6 里面是否有一些高级的方法能够直接实现？

数组的扁平化其实就是将一个嵌套多层的数组 array（嵌套可以是任何层数）转换为只有一层的数组。

```js
var arr = [1, [2, [3, 4，5]]];
console.log(flatten(arr)); // [1, 2, 3, 4，5]
```

### 1、递归实现

```js
function flatten(arr){
  let result = [];
  arr.forEach(element => {
    if (Array.isArray(element)){
      result = result.concat(flatten(element));
    }else {
      result.push(element)
    }
  });
  return result;
}
```

### 2、reduce 函数

```js
function flatten(arr){
  return arr.reduce(function(pre,next){
    return pre.concat(Array.isArray(next)?flatten(next):next)
  },[])
}
```

### 3、扩展运算符实现

```js
function flatten(arr) {
  while (arr.some(item => Array.isArray(item))) {
    arr = [].concat(...arr)
  }
  return arr
}
```

### 4、split 和 toString 共同处理

```javascript
function flatten(arr) {
    return arr.toString().split(',');
}
```

### 5、调用 ES6 中的 flat

flat 方法的语法：

> arr.flat([depth])

发现对数组的嵌套层数不确定的时候，最好直接使用 Infinity，可以达到扁平化。

```javascript
function flatten(arr) {
  return arr.flat(Infinity);
}
```

### 6、正则和 JSON 方法共同处理

采用了将 JSON.stringify 的方法先转换为字符串，然后通过正则表达式过滤掉字符串中的数组的方括号，最后再利用 JSON.parse 把它转换成数组。

```javascript
function flatten(arr) {
  let str = JSON.stringify(arr);
  str = str.replace(/(\[|\])/g, '');
  str = '[' + str + ']';
  return JSON.parse(str); 
}
```

![image-20220913191341926](D:\Github\Notes\Web\image\image-20220913191341926.png)
